<?xml version="1.0" encoding="UTF-8"?>
<!--
  $HeadURL::                                                                                     $
  $Id$
  
  Copyright (c) 2007-2008 by Topaz, Inc.
  http://topazproject.org
  
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
  
  http://www.apache.org/licenses/LICENSE-2.0
  
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  
  This file contains most of the defaults for the ambra webapp. However, there may be additional
  defaults in the conf-helper library's global-defaults.xml. Additionally, if in dev mode, some
  of these values may be overridden by settings in defaults-dev.xml. Finally, look for overrides
  in /etc/topaz/ambra.xml.
  
  See also libs/conf-helper/src/main/resources/globa-defaults.xml
-->
<config>
  <network>
    <hosts>
      <!-- For multibox install, change the following entires to the appropriate FQHNs -->
      <cas>${network.hosts.default}</cas>
      <registration>${network.hosts.cas}</registration>
      <fedora>${network.hosts.default}</fedora>
      <mulgara>${network.hosts.default}</mulgara>
      <ambra>${network.hosts.default}</ambra>
    </hosts>
  </network>
  <ambra>
    <platform>
      <host>${network.hosts.default}:${network.ports.default}</host>
      <port>
        <http>${network.ports.default}</http>
        <https>${network.ports.ambra-ssl}</https>
      </port>

      <appContext></appContext><!-- web application context; leave empty if deployed in root directory  -->
      <resourceSubDir></resourceSubDir><!-- used only if web resources like images/css are deployed in a separate directory; rarely used  -->
      <defaultJournalName>AmbraJournal</defaultJournalName>      
      <!-- Action for retrieving an article where doi is appended to this string -->
      <articleAction>article/</articleAction>

      <!-- common display constants -->
      <name>Public Library of Science</name>
      <email>
        <general>webmaster@plos.org</general>
        <feedback>webmaster@plos.org</feedback>
      </email>
      <copyright>
        This work is licensed under a Creative Commons Attribution-Share Alike 3.0 License,
        http://creativecommons.org/licenses/by-sa/3.0/
      </copyright>

      <webserverUrl>http://${network.hosts.default}:${network.ports.default}${ambra.platform.appContext}/</webserverUrl>
    </platform>


    <!-- virtual journal config -->
    <virtualJournals>
      <!-- default values used if no virtual journal rules match -->
      <default>
        <journal>AmbraJournal</journal>
        <description>Ambra Journal</description>
        <mappingPrefix>/journals/ambraJournal</mappingPrefix>
        <url>http://ambra.topazproject.org</url>
      </default>
      <!-- entries to config each virtual journal -->
      <!-- comma separated list of virtual journal names -->
      <journals>OverlayJournal</journals>
      <OverlayJournal>
        <description>Overlay Journal</description>
        <mappingPrefix>/journals/overlayJournal</mappingPrefix>
        <rules>
          <host>.*overlay.*</host>
          <plosJournal>OverlayJournal</plosJournal>
        </rules>
        <url>http://overlay.topazproject.org</url>
        <!-- Atom feed overrides -->
        <platform>
          <feed>
            <title>Overlay Journal</title>
            <id>info:doi/10.1371/feed.tpvj</id>
          </feed>
        </platform>
      </OverlayJournal>
      <!-- virtual journal config entry
        <${journalName}>
        <description>${display for Admin, etc.}</description>
        <mappingPrefix>${URI path prefix for virtual journal resources}</mappingPrefix>
        <rules>
        <${httpHeader}>${regex to match against HTTP Header value}</${httpHeader}>
        <${httpHeader}>${regex to match against HTTP Header value}</${httpHeader}>
        </rules>
        <platform>
        <feed>
        <title>${journalName}</title>
        <id>info:doi/10.1371/feed.${journalCode}</id>
        </feed>
        </platform>
        </${journalName}>
      -->
    </virtualJournals>
    
    <services>
      <topaz>
        <!-- must match the name of a bean in the applicationContext.xml -->
        <blobStore>fedoraBlobStore</blobStore>
        <itql>
          <uri>rmi://${ambra.spring.server.mulgara}/topazproject</uri>
        </itql>
      </topaz>
      <search>
        <snippetsMax>3</snippetsMax><!-- Number of snippets to show per document -->
        <fieldMaxLength>50</fieldMaxLength><!-- Max chars per indexed field? -->
        <cacheDuration>600000</cacheDuration><!-- Milliseconds to cache search results -->
        <pageSize>10</pageSize><!-- Number of results per page -->
        <fetchSize>10</fetchSize><!-- Number of results to fetch at a time -->
        <indexpath>/var/lib/topaz/data/lucene</indexpath>
        <defaultfields>description,title,body,creator</defaultfields>
      </search>

      <!-- URLs to access the CAS Single Signon Server.
        login: the login page
        logout: the logout page
        proxy-receptor: the URL for getting a proxy ticket using a PGT
        proxy-validate: the URL to validate/authenticate proxy and regular tickets
      -->
      <cas>
        <url>
          <base>https://${network.hosts.cas}:${network.ports.cas-ssl}/cas</base>
          <login>${ambra.services.cas.url.base}/login</login>
          <logout>${ambra.services.cas.url.base}/logout</logout>
          <proxy-receptor>${ambra.services.cas.url.base}/proxy</proxy-receptor>
          <proxy-validate>${ambra.services.cas.url.base}/proxyValidate</proxy-validate>
        </url>
      </cas>

      <!-- defaults for generating an Atom Feed -->
      <feed>
        <title>Overlay Journal</title>
        <tagline>Publishing science, accelerating research</tagline>
        <icon>${webserver-url}images/favicon.ico</icon>
        <id>info:doi/1371/feed.ambr</id><!-- Unique id. Should change for different criteria -->
        <extended><!-- Configuration of extended atom feeds -->
          <prefix>plos</prefix><!-- namespace prefix for custom elements -->
          <namespace>http://www.plos.org/atom/ns#plos</namespace><!-- custom element namespace -->
        </extended>
        <basePath>/article/</basePath><!-- Path to rss feeds after journal context -->
        <defaultFile>feed</defaultFile><!-- Default rss feed if none other specified -->
        <categoryPrefix>feed?category=</categoryPrefix><!-- File prefix for a specific category -->
        <defaultName>New Articles</defaultName><!-- Name of default feed (prefixed by journal) -->
        <defaultDuration>3</defaultDuration><!-- Default duraiton in months -->
      </feed>

      <registration>
        <appContext>/ambra-registration</appContext><!-- app context for registration -->
        <url>
          <base>
            https://${network.hosts.cas}:${network.ports.cas-ssl}${ambra.services.registration.appContext}
          </base>
          <!-- properties below are used by pub app to determine where to send the user for certain actions -->
          <registration>${ambra.services.registration.url.base}/register.action</registration>
          <change-password>${ambra.services.registration.url.base}/changePassword.action</change-password>
          <change-email>${ambra.services.registration.url.base}/changeEmail.action</change-email>
        </url>
      </registration>
      
      <documentManagement>
        <ingestSourceDir>
          /var/spool/ambra/ingestion-queue
        </ingestSourceDir>
        <ingestDestinationDir>
          /var/spool/ambra/ingested
        </ingestDestinationDir>
      </documentManagement>>
      
      <!-- crossref information - set parameters and sendToXref to true to turn on -->
      <crossref>
        <plos>
          <doiurl>http://...</doiurl><!-- URL where your URIs can be found -->
          <email>webmaster@your-org</email><!-- email address to send info to -->
        </plos>
        <login>crossref-username</login><!-- crossref login -->
        <password>your-password</password><!-- crossref password -->
        <area>test</area><!-- set to "live" to activate, "test" for dev -->
        <sendToXref>false</sendToXref><!-- Set to true to turn on crossref posting -->
        <post>
          <url>
            http://doi.crossref.org/servlet/deposit?operation=doMDUpload&amp;login_id=${ambra.services.crossref.login}&amp;login_passwd=${ambra.services.crossref.password}&amp;area=${ambra.services.crossref.area}
          </url>
        </post>
      </crossref>
      
    </services>

    <!-- Define defaults for spring - must be redone soon -->
    <spring>
      <server>
        <ambra>${network.hosts.ambra}:${network.ports.ambra}</ambra>
        <search>${network.hosts.ambra}:${network.ports.ambra}</search>
        <mulgara>${network.hosts.mulgara}</mulgara>
      </server>
      <homesite>${network.hosts.default}</homesite>
      <service>
        <!-- This may need to be mucked with to be just one -->
        <search>${ambra.services.topaz.fedoraGSearch.urls.url}</search>
      </service>
    </spring>

    <articleTypeList>
      <articleType>
        <typeUri>http://rdf.plos.org/RDF/articleType/Research%20Article</typeUri>
        <typeHeading>Research Article</typeHeading>
        <default>true</default>
      </articleType>
      <articleType>
        <typeUri>http://rdf.plos.org/RDF/articleType/Issue%20Image</typeUri>
        <typeHeading>Issue Image</typeHeading>
        <imageSetConfigName>issueImage</imageSetConfigName>
      </articleType>
    </articleTypeList>

    <!--
      # This section defines the various journals and the css and javascript files which should be
      # included on each page as well as the page title.  The values within the <default> tag are used
      # if any of the values are missing in the <page> definitions.  Note, that the title, css, and
      # javascript level values are entirely replaced, they are not additive.  Override config files
      # may define values for each of those three variables and they will supsercede values present
      # in subsequent config values.  The lookup for values is as follows:
      # 1. Page defined in journal
      # 2. Default value defined in journal
      # 3. Page defined in default journal
      # 4. Default value in default journal
      # To define an empty value for a certain page so that it doesn't use defaults, just put the
      # element tag with no value, e.g. <javascript></javascript>
    -->
    <freemarker>
      <journal>
        <name>Ambra Journal</name>
        <metaKeywords>Ambra\, RDF</metaKeywords>
        <metaDescription>
          Ambra is a new Open Source software applications development project to create an
          innovative, end-to-end electronic publishing system that will become a powerful driver of
          the Open Access movement.
        </metaDescription>
        <articleTitlePrefix>Ambra Journal:</articleTitlePrefix>
        <displayName>Ambra Journal</displayName>
        <default>
          <title>Ambra : It's refreshing.</title>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_default.js</file>
            <file>/javascript/dojo/dojo_home.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/dojoRequire_default.ftl</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
          </javascript>
        </default>
        <page>
          <name>/journals/ambraJournal/index.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/home.css</file>
            <file>/css/article_markup.css</file>
          </css>
          <javascript>
            <file>/javascript/dojo/dojo_home.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/htmlUtil.js</file>
            <file>/javascript/dojoRequire_default.ftl</file>
            <file>/javascript/config_home.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
          </javascript>
        </page>
        <page>
          <name>/article/article_body.ftl</name>
          <title>CODE_ARTICLE_TITLE</title>
          <css>
            <file>/css/star_rating.css</file>
            <file>/css/rating.css</file>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_article.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/annotation.js</file>
            <file>/javascript/topaz/displayComment.js</file>
            <file>/javascript/topaz/rating.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/floatingMenu.js</file>
            <file>/javascript/topaz/navigationUtil.js</file>
            <file>/javascript/dojoRequire_article.ftl</file>
            <file>/javascript/formSetup_article.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_article.js</file>
          </javascript>
        </page>
        <page>
          <name>/article/browseIssue.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_article.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/annotation.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/floatingMenu.js</file>
            <file>/javascript/topaz/navigationUtil.js</file>
            <file>/javascript/dojoRequire_article.ftl</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_article.js</file>
          </javascript>
        </page>
        <page>
          <name>/article/browseVolume.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/ambraTabs.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_article.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/annotation.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/floatingMenu.js</file>
            <file>/javascript/topaz/navigationUtil.js</file>
            <file>/javascript/dojoRequire_article.ftl</file>
            <file>/javascript/dynamicDrive/tabcontent.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
          </javascript>
        </page>
        <page>
          <name>/discussion/discussion.ftl</name>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_discussion.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/dojoRequire_discussion.ftl</file>
            <file>/javascript/topaz/responsePanel.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_discussion.js</file>
          </javascript>
        </page>
        <page>
          <name>/discussion/startDiscussion.ftl</name>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_discussion.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/dojoRequire_discussion.ftl</file>
            <file>/javascript/topaz/responsePanel.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_newDiscussion.js</file>
          </javascript>
        </page>
        <page>
          <name>/rating/index.ftl</name>
          <css>
            <file>/css/star_rating.css</file>
            <file>/css/rating.css</file>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/article_markup.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_discussion.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/rating.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/dojoRequire_discussion.ftl</file>
            <file>/javascript/topaz/responsePanel.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_discussion.js</file>
          </javascript>
        </page>
        <page>
          <name>/article/imageWindow.ftl</name>
          <css>
            <file>/css/images.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/config_slideshow.js</file>
            <file>/javascript/slideshowReference.ftl</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/dojoRequire_slideshow.ftl</file>
            <file>/javascript/topaz/slideshow.js</file>
            <file>/javascript/init_slideshow.js</file>
          </javascript>
        </page>
        <page>
          <name>/article/imageWindowLarge.ftl</name>
          <css>
            <file>/css/images.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/dojoRequire_slideshow.ftl</file>
          </javascript>
        </page>
        <page>
          <name>/article/emailArticle.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/forms.css</file>
            <file>/css/static.css</file>
          </css>
        </page>
        <page>
          <name>/article/emailSuccess.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/forms.css</file>
            <file>/css/static.css</file>
          </css>
        </page>
        <page>
          <name>/article/browse.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/article_markup.css</file>
          </css>
        </page>
        <page>
          <name>/feedback/feedbackEntry.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/forms.css</file>
            <file>/css/static.css</file>
          </css>
        </page>
        <page>
          <name>/feedback/feedbackSuccess.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/forms.css</file>
            <file>/css/static.css</file>
          </css>
        </page>
        <page>
          <name>/user/alerts.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/forms.css</file>
            <file>/css/static.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
          </javascript>
        </page>
        <page>
          <name>/user/createNewUser.ftl</name>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/htmlUtil.js</file>
            <file>/javascript/dojoRequire_profile.ftl</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_newProfile.js</file>
          </javascript>
        </page>
        <page>
          <name>/user/editPlosAlerts.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/forms.css</file>
            <file>/css/static.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/htmlUtil.js</file>
            <file>/javascript/dojoRequire_profile.ftl</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_ambraAlerts.js</file>
          </javascript>
        </page>
        <page>
          <name>/user/editUser.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/forms.css</file>
            <file>/css/static.css</file>
          </css>
          <javascript>
            <file>/javascript/browserDetection.js</file>
            <file>/javascript/dojo/dojo_ambra.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/formUtil.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/htmlUtil.js</file>
            <file>/javascript/dojoRequire_profile.ftl</file>
            <file>/javascript/config_profile.js</file>
            <file>/javascript/topaz/horizontalTabs.js</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
            <file>/javascript/init_profile.js</file>
          </javascript>
        </page>
        <page>
          <name>/static/about.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/static.css</file>
          </css>
        </page>
      </journal>

      <!-- Overlay Journal. Anything you want to override must be listed here -->
      <journal>
        <name>Overlay Journal</name>
        <metaKeywords>Overlay Journal\, Secondary\, Generic\, Default</metaKeywords>
        <metaDescription>This is an example second journal on Topaz.</metaDescription>
        <articleTitlePrefix>Overlay Journal:</articleTitlePrefix>
        <displayName>Overlay Journal</displayName>
        <default>
          <title>
            Overlay Journal: Serving as an Example for the Topaz Configuration community
          </title>
        </default>
        <page>
          <name>/journals/overlayJournal/index.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/home.css</file>
            <file>/css/article_markup.css</file>
          </css>
          <javascript>
            <file>/javascript/dojo/dojo_home.js</file>
            <file>/javascript/topaz/topaz.js</file>
            <file>/javascript/topaz/domUtil.js</file>
            <file>/javascript/topaz/htmlUtil.js</file>
            <file>/javascript/dojoRequire_default.ftl</file>
            <file>/javascript/init_global.js</file>
            <file>/javascript/init_navigation.js</file>
          </javascript>
        </page>
        <page>
          <name>/article/article_body.ftl</name>
          <title>CODE_ARTICLE_TITLE</title>
        </page>
        <page>
          <name>/journals/overlayJournal/static/about.ftl</name>
          <css>
            <file>/css/screen.css</file>
            <file>/css/iepc.css</file>
            <file>/css/static.css</file>
          </css>
        </page>
      </journal>
    </freemarker>
  </ambra>
</config>
