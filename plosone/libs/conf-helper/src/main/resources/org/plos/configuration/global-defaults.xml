<?xml version="1.0" encoding="UTF-8" ?>
<!--
  $HeadURL::                                                                                      $
  $Id$

  Copyright (c) 2006 by Topaz, Inc.
  http://topazproject.org

  Licensed under the Educational Community License version 1.0
  http://opensource.org/licenses/ecl1.php

  This is the defaults used by any plos associated webapp and/or command line utility.
  The ConfigurationStore singleton loads this first. Settings in the defaults.xml
  resource in libs and webapps that use ConfigurationStore take precedence and
  override all the settings here. Although normally stuff in defaults.xml simply
  suplements these settings and it is what is in /etc that overrides these.
-->
<config>
  <network>
    <hosts>
      <!-- Set hosts.default to FQHN (not localhost) for a singleboxinstall
           (or to webhead FQHN for multibox install) -->
      <default>localhost</default>
      <mailhost>localhost</mailhost>
      <!-- For multibox install, change the following entires to the appropriate FQHNs -->
      <cas>${network.hosts.default}</cas>
      <registration>${network.hosts.cas}</registration>
      <fedora>${network.hosts.default}</fedora>
      <mulgara>${network.hosts.default}</mulgara>
      <plosone>${network.hosts.default}</plosone>
      <!-- TODO: Use registration apropriately every where. Pull out doi-resolver (& search?) -->
    </hosts>
    <ports>
      <!-- For webhead, set default to empty (not 80) -->
      <default>${network.ports.plosone}</default>
      <!-- If 443, set cas-ssl to empty -->
      <cas-ssl>7443</cas-ssl>

      <plosone>8080</plosone>
      <plosone-ssl>10443</plosone-ssl>
      <fedora>9090</fedora>
      <mulgara>9091</mulgara>

      <registration-ssl>${network.ports.cas-ssl}</registration-ssl>
    </ports>
  </network>

  <cas>
    <!-- The following entries defnine how the java webapp talk to the database.
         For example, talking to postgresql, you need the database name at the end of the url
         The user and password are for the database as well. -->
    <db>
      <user>casuser</user>
      <password>caspass</password>
      <url>jdbc:postgresql://localhost/casdb</url>
      <driver>org.postgresql.Driver</driver>
    </db>
  </cas>
    
  <topaz>
    <mulgara>
      <baseuri>local:///topazproject</baseuri>
    </mulgara>
    <objects>
      <base-uri>info:doi/10.1371/</base-uri>
    </objects>
    <models>
      <ri type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=ri</ri>
      <articles type="${topaz.models.ri[@type]}">${topaz.models.ri}</articles>
      <annotations type="${topaz.models.ri[@type]}">${topaz.models.ri}</annotations>
      <users type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=users</users>
      <grants type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=grants</grants>
      <revokes type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=revokes</revokes>
      <pp type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=pp</pp>
      <preferences type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=preferences</preferences>
      <profiles type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=profiles</profiles>
      <ratings type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=ratings</ratings>
      <alerts type="http://topazproject.org/models#filter">${topaz.mulgara.baseuri}#filter:model=alerts</alerts>
      <str type="http://topazproject.org/models#StringCompare">${topaz.mulgara.baseuri}#str</str>
      <xsd type="http://mulgara.org/mulgara#XMLSchemaModel">${topaz.mulgara.baseuri}#xsd</xsd>
    </models>
    <services>
      <!-- Configuration to talk to Fedora -->
      <fedora>
        <base-url>http://${network.hosts.fedora}:${network.ports.fedora}/fedora/</base-url>
        <uri>${topaz.services.fedora.base-url}services/management</uri>
        <auth-method>BASIC</auth-method>
        <userName>fedoraAdmin</userName>
        <password>fedoraAdmin</password>
      </fedora>
      <fedoraUploader>
        <uri>${topaz.services.fedora.base-url}management/upload</uri>
        <auth-method>${topaz.services.fedora.auth-method}</auth-method>
        <userName>${topaz.services.fedora.userName}</userName>
        <password>${topaz.services.fedora.password}</password>
      </fedoraUploader>

      <!-- Configuration to talk to Mulgara -->
      <itql>
        <uri>http://${network.hosts.mulgara}:${network.ports.mulgara}/mulgara-service/services/ItqlBeanService</uri>
        <auth-method>NONE</auth-method>
      </itql>
      <itql-admin>
        <uri>${topaz.services.itql.uri}</uri>
        <auth-method>NONE</auth-method>
      </itql-admin>
    </services>
    
    <utilities>
      <image-magick>
        <executable-path>/usr/bin/convert</executable-path>
        <temp-directory>/tmp</temp-directory>
      </image-magick>
    </utilities>

    <server>
      <!-- Any remaining topaz services (search) are in the plosone container
           TODO: Use of these parameters should be deprecated -->
      <hostname>${network.hosts.plosone}</hostname>
      <https-port>${network.ports.plosone-ssl}</https-port>
    </server>

    <!-- Configuration to talk to CAS -->
    <cas-server>
      <base-url>https://${network.hosts.cas}:${network.ports.cas-ssl}/cas</base-url>
    </cas-server>

    <fedoragsearch>
      <urls>
        <url>http://${network.hosts.plosone}:${network.ports.plosone}/ws-search-webapp/services/FedoraGenericSearchServicePort</url>
      </urls>
      <repository>Topaz</repository>
      <index>TopazIndex</index>
      <indexDocXslt>topazFoxmlToLucene</indexDocXslt>
      <resultPageXslt>copyXml</resultPageXslt>
      <fgsrepository>
        <fedoraSoap>${topaz.services.fedora.base-url}services</fedoraSoap>
        <fedoraUser>${topaz.services.fedora.userName}</fedoraUser>
        <fedoraPass>${topaz.services.fedora.password}</fedoraPass>
      </fgsrepository>
    </fedoragsearch>

    <articles>
      <pdpName>standard-pdp</pdpName>
    </articles>
    <annotations>
      <pdpName>standard-pdp</pdpName>
    </annotations>
    <replies>
      <pdpName>standard-pdp</pdpName>
    </replies>
    <permissions>
      <pdpName>standard-pdp</pdpName>
    </permissions>
    <profiles>
      <pdpName>standard-pdp</pdpName>
    </profiles>
    <preferences>
      <pdpName>standard-pdp</pdpName>
    </preferences>
    <user-accounts>
      <pdpName>standard-pdp</pdpName>
    </user-accounts>
    <user-roles>
      <pdpName>standard-pdp</pdpName>
    </user-roles>
    <ratings>
      <pdpName>standard-pdp</pdpName>
    </ratings>
    <alerts>
      <pdpName>standard-pdp</pdpName>
    </alerts>
    <search>
      <pdpName>standard-pdp</pdpName>
    </search>
    <access>
      <pdpName>standard-pdp</pdpName>
    </access>
  </topaz>
</config>
