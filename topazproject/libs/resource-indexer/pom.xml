<?xml version="1.0"?><project>
  <parent>
    <artifactId>topazproject-libs</artifactId>
    <groupId>org.topazproject</groupId>
    <version>0.5-SNAPSHOT</version>
  </parent>
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.topazproject</groupId>
  <artifactId>resource-indexer</artifactId>
  <name>Fedora resource indexer</name>
  <version>0.5-SNAPSHOT</version>
  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>info.fedora</groupId>
      <artifactId>server</artifactId>
      <version>${fedora.version}</version>
      <type>tar</type>
      <scope>provided</scope>
    </dependency>
  </dependencies>
  <build>
    <!-- prevent maven compiler plugin from firing -->
    <sourceDirectory>none</sourceDirectory>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-antrun-plugin</artifactId>
        <executions>
          <execution>
            <id>untar-fedora-server</id>
            <phase>generate-sources</phase>
            <configuration>
              <tasks>
                <untar overwrite="false"
                  src="${settings.localRepository}/info/fedora/server/${fedora.version}/server-${fedora.version}.tar"
                  dest="${generated.sources}">
                </untar>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
          <execution>
            <id>compile</id>
            <phase>compile</phase>
            <configuration>
              <tasks>
                <property name="fedora.webapp" value="${fedora.tomcat.home}/webapps/fedora"/>
                <mkdir dir="target/classes"/>
                <javac srcdir="src/main/java" destdir="target/classes" 
                  source="${maven.compiler.source}"
                  target="${maven.compiler.target}">
                  <classpath>
                    <pathelement path="${maven.compiler.path}"/>
                    <pathelement path="${fedora.webapp}/WEB-INF/classes"/>
                    <pathelement path="${fedora.webapp}/WEB-INF/lib/trippi.jar"/>
                  </classpath>
                </javac>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        </executions>
        <dependencies>
          <dependency>
            <groupId>sun.jdk</groupId>
            <artifactId>tools</artifactId>
            <version>${maven.compiler.source}</version>
            <scope>system</scope>
            <systemPath>${java.home}/../lib/tools.jar</systemPath>
          </dependency>
        </dependencies>
      </plugin>
    </plugins>
  </build>
  <properties>
    <generated.sources>${project.build.directory}/generated-sources</generated.sources>
    <fedora.version>2.1.1</fedora.version>
    <fedora.server.home>${generated.sources}/fedora-${fedora.version}/server</fedora.server.home>
    <fedora.tomcat.home>${fedora.server.home}/jakarta-tomcat-5.0.28</fedora.tomcat.home>
  </properties>
</project>
